<% if (theme.waline.serverURL) { %>
  <head>
    <script src="//cdn.jsdelivr.net/npm/@waline/client"></script>
  </head>
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createScript('<%= url_join(theme.static_prefix.waline, 'Waline.min.js') %>', function() {
        var options = Object.assign(
          <%- JSON.stringify(theme.waline || {}) %>,
          {
            el: '#waline',
            path: <%= theme.waline.path %>
          }
        )
        new Waline(options);

		wa_ccc = "waline-comment-count-container"
		var i=document.getElementById(wa_ccc)
		i.style.display = 'inline'

        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          Fluid.plugins.initFancyBox('#waline .vcontent img:not(.vemoji)');
        })

      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>
<% } %>
